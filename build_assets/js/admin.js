var File=document.getElementById("File"),file,reader;C.addHandler(File,"change",function(a){var b=document.getElementById("imgPanel");b.innerHTML="";for(var c=0;c<File.files.length;c++)file=File.files[c],reader=new FileReader,reader.readAsDataURL(file),reader.onload=function(a){var c=this.result,d=document.createElement("img");d.src=c;document.createElement("div");b.appendChild(d)}});var ImgUpload=document.getElementById("ImgUpload");C.addHandler(ImgUpload,"submit",function(a){if(File.files.length){var b=new FormData(ImgUpload),c=new XMLHttpRequest;c.open("post","/images/upload?path="+ImgUpload.path.value,!0),c.onload=function(a){alert("上传完成!")},c.send(b)}return a.preventDefault(),!1});var SelRoot=document.getElementById("SelRoot"),panel=document.getElementById("imgPanel"),path=document.getElementById("Path");C.addHandler(SelRoot,"change",function(a){0!=SelRoot.value&&C.post("/files/getFiles",{path:SelRoot.value},function(a){var b,c=JSON.parse(a).files,d=location.host;b=document.createElement("div"),c.forEach(function(a){img=document.createElement("img"),img.src="http://"+d+"/"+SelRoot.value+a,b.appendChild(img),path.value=SelRoot.value}),panel.innerHTML=b.innerHTML},function(){alert("获取文件出错")})});var $colBox=C.getElementsByClass("news")[0];C.addHandler($colBox,"click",function(a){var a=a||window.event,b=a.target||a.srcElement;if(C.hasClass(b,"collect")&&C.hasClass(b,"admin")){var c={id:b.getAttribute("data-id"),isCollect:b.getAttribute("data-collect")};C.get("/news/collect",c,function(a){var a=JSON.parse(a);"ok"==a.msg&&("false"==c.isCollect?(b.innerHTML="已收藏",b.setAttribute("data-collect","true")):(b.innerHTML="添加收藏",b.setAttribute("data-collect","false")))})}});